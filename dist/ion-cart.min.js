!function(t){var e=t.module("ionicShop.services",["ionic"]);e.service("Products",["$http",function(t){this.products=[],this.checkout={},this.removeProduct=function(t){this.products.forEach(function(e,n){t.id===e.id&&(this.products.splice(n,1),this.updateTotal())}.bind(this))},this.addOneProduct=function(t){t.quantity++,this.updateTotal()},this.removeOneProduct=function(t){t.quantity--,this.updateTotal()},this.cartTotal=function(){var t=0;return this.products.forEach(function(e){t+=e.price*e.quantity}),e(t)};var e=function(t){return t.toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")};this.updateTotal=function(){this.total=this.cartTotal()}.bind(this),this.updateTotal(),this.getProducts=function(e){t.get("/admin/panel/products").success(function(t){this.products=t,e&&e()}.bind(this))}}]),e.service("CheckoutValidation",function(){this.validateCreditCardNumber=function(t){return Stripe.card.validateCardNumber(t)},this.validateExpiry=function(t,e){return Stripe.card.validateExpiry(t,e)},this.validateCVC=function(t){return Stripe.card.validateCVC(t)},this.validateEmail=function(t){var e=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return e.test(t)},this.validateZipcode=function(t){var e=/(^\d{5}$)|(^\d{5}-\d{4}$)/;return e.test(t)},this.checkAll=function(t){if(0===Object.keys(t).length)return!1;for(var e in t){if("cc"===e&&!this.validateCreditCardNumber(t[e]))return!1;if("exp"===e&&!this.validateExpiry(t[e].slice(0,2),t[e].slice(3)))return!1;if("cvc"===e&&!this.validateCVC(t[e]))return!1;if("email"===e&&!this.validateEmail(t[e]))return!1;if("zipcode"===e&&!this.validateZipcode(t[e]))return!1}return!0}.bind(this)}),e.service("stripeCheckout",["Products","CheckoutValidation","$http",function(t,e,n){this.setStripeKey=function(t){Stripe.setPublishableKey(t)},this.processCheckout=function(t,e){var n=t.cc,i=t.exp.slice(0,2),c=t.exp.slice(3),o=t.cvc;Stripe.card.createToken({number:n,cvc:o,exp_month:i,exp_year:c},e)},this.stripeCallback=function(t,e){return{status:t,response:e}}}])}(angular),function(t){var e=t.module("ionicShop.directives",["ionic","ionicShop.services"]);e.directive("ionCart",["Products","$templateCache",function(t){var e=function(e){e.$watch("products.length",function(){t.updateTotal(),e.emptyProducts=t.products.length?!1:!0}),e.emptyProducts=t.products.length?!1:!0,e.addProduct=function(e){t.addOneProduct(e)},e.removeProduct=function(e){e.quantity<=1?t.removeProduct(e):t.removeOneProduct(e)}};return{restrict:"AEC",templateUrl:"cart-item.html",link:e,scope:{products:"="}}}]),e.directive("ionProductImage",["$timeout","$ionicModal","$ionicSlideBoxDelegate","$templateCache",function(t,e,n){var i=function(i,c){i.closeModal=function(){i.modal.hide(),i.modal.remove()},c.on("click",function(){e.fromTemplateUrl("cart-image-modal.html",{animation:"slide-left-right",scope:i}).then(function(e){i.modal=e,i.modal.show(),t(function(){n.update()})})})};return{restrict:"A",link:i,scope:"="}}]),e.directive("ionCheckout",["$state","$templateCache",function(t){var e=function(e,n){n.addClass("bar bar-footer bar-dark"),n.on("click",function(){t.go(e.path)}),n.on("touchstart",function(){n.css({opacity:.8})}),n.on("touchend",function(){n.css({opacity:1})})};return{restrict:"AEC",templateUrl:"checkout-footer.html",scope:{path:"=path"},link:e}}]),e.directive("ionPurchase",["Products","$templateCache",function(t){var e=function(e,n){e.$watch(function(){return t.total},function(){e.total=t.total}),e.checkout=t.checkout,e.total=t.total,n[0].hasAttribute("has-address")&&(e.hasAddressDir=!0),n[0].hasAttribute("has-email")&&(e.hasEmailDir=!0),n[0].hasAttribute("has-name")&&(e.hasNameDir=!0)};return{restrict:"AEC",templateUrl:"purchase.html",link:e}}]),e.directive("ionPurchaseFooter",["$compile","Products","stripeCheckout","CheckoutValidation","$templateCache",function(e,n,i,c){var o=function(e,o){e.checkout=n.checkout,e.processCheckout=i.processCheckout,e.stripeCallback=i.stripeCallback,o.addClass("bar bar-footer bar-dark"),o.on("click",function(){if(c.checkAll(e.checkout))e.processCheckout(e.checkout,e.stripeCallback);else{var n=document.getElementsByTagName("ion-purchase")[0].children[0];t.element(n).html("Please correct the following:").css({color:"#ED303C",opacity:1})}}),o.on("touchstart",function(){o.css({opacity:.8})}),o.on("touchend",function(){o.css({opacity:1})})};return{restrict:"AEC",templateUrl:"purchase-footer.html",link:o}}]),e.directive("checkoutCard",["$templateCache",function(){var t=function(){};return{restrict:"AEC",link:t,templateUrl:"card-form.html"}}]),e.directive("cardNumInput",["$timeout","CheckoutValidation","$templateCache",function(e,n){var i=function(i,c){var o=(c.children()[0].children[0],c.children()[0].children[1]);i.onNumBlur=function(){i.checkout.cc&&(t.element(o).removeClass("ion-card"),t.element(o).addClass("ion-loading-d"),e(function(){return n.validateCreditCardNumber(i.checkout.cc)?(t.element(o).removeClass("ion-loading-d"),void t.element(o).addClass("ion-checkmark-round").css({color:"#1fda9a"})):(t.element(o).removeClass("ion-loading-d"),void t.element(o).addClass("ion-close-round").css({color:"#ED303C"}))},300))},i.onNumFocus=function(){t.element(o).removeClass("ion-checkmark-round ion-close-round"),t.element(o).addClass("ion-card").css({color:"#333"})}};return{restrict:"AEC",link:i,templateUrl:"card-num-input.html"}}]),e.directive("cardExpInput",["$timeout","CheckoutValidation","$templateCache",function(e,n){var i=function(i,c){var o=(c.children()[0].children[0],c.children()[0].children[1]);i.onExpBlur=function(){i.checkout.exp&&(t.element(o).addClass("ion-loading-d"),e(function(){return i.checkout.exp&&n.validateExpiry(i.checkout.exp.slice(0,2),i.checkout.exp.slice(3))?(t.element(o).removeClass("ion-loading-d"),void t.element(o).addClass("ion-checkmark-round").css({color:"#1fda9a"})):(t.element(o).removeClass("ion-loading-d"),void t.element(o).addClass("ion-close-round").css({color:"#ED303C"}))},300))},i.onExpFocus=function(){t.element(o).removeClass("ion-checkmark-round ion-close-round").css({color:"#333"})}};return{restrict:"AEC",link:i,templateUrl:"card-exp-input.html"}}]),e.directive("cardCvcInput",["$timeout","CheckoutValidation","$templateCache",function(e,n){var i=function(i,c){var o=(c.children()[0].children[0],c.children()[0].children[1]);i.onCvcBlur=function(){i.checkout.cvc&&(t.element(o).addClass("ion-loading-d"),e(function(){return n.validateCVC(i.checkout.cvc)?(t.element(o).removeClass("ion-loading-d"),void t.element(o).addClass("ion-checkmark-round").css({color:"#1fda9a"})):(t.element(o).removeClass("ion-loading-d"),void t.element(o).addClass("ion-close-round").css({color:"#ED303C"}))},300))},i.onCvcFocus=function(){t.element(o).removeClass("ion-checkmark-round ion-close-round").css({color:"#333"})}};return{restrict:"AEC",link:i,templateUrl:"card-cvc-input.html"}}]),e.directive("checkoutAddress",["$templateCache",function(){var t=function(){};return{restrict:"AEC",link:t,templateUrl:"address.html"}}]),e.directive("addressOneInput",["$templateCache",function(){var t=function(){};return{restrict:"AEC",link:t,templateUrl:"address-line-one.html"}}]),e.directive("addressTwoInput",["$templateCache",function(){var t=function(t){t.onAddrTwoBlur=function(){},t.onAddrTwoFocus=function(){}};return{restrict:"AEC",link:t,templateUrl:"address-line-two.html"}}]),e.directive("cityInput",["$templateCache",function(){var t=function(t){t.onCityBlur=function(){},t.onCityFocus=function(){}};return{restrict:"AEC",link:t,templateUrl:"city-input.html"}}]),e.directive("stateInput",["$templateCache",function(){var t=function(t){t.onStateBlur=function(){},t.onStateFocus=function(){}};return{restrict:"AEC",link:t,templateUrl:"state-input.html"}}]),e.directive("zipInput",["$timeout","CheckoutValidation","$templateCache",function(e,n){var i=function(i,c){var o=c.children()[0].children[1];i.onZipBlur=function(){i.checkout.zipcode&&(t.element(o).addClass("ion-loading-d"),e(function(){return n.validateZipcode(i.checkout.zipcode)?(t.element(o).removeClass("ion-loading-d"),void t.element(o).addClass("ion-checkmark-round").css({color:"#1fda9a"})):(t.element(o).removeClass("ion-loading-d"),void t.element(o).addClass("ion-close-round").css({color:"#ED303C"}))},300))},i.onZipFocus=function(){t.element(o).removeClass("ion-checkmark-round ion-close-round").css({color:"#333"})}};return{restrict:"AEC",link:i,templateUrl:"zipcode-input.html"}}]),e.directive("checkoutName",["$templateCache",function(){var t=function(){};return{restrict:"AEC",link:t,templateUrl:"name-input.html"}}]),e.directive("lastNameInput",["$templateCache",function(){var t=function(){};return{restrict:"AEC",link:t,templateUrl:"first-name-input.html"}}]),e.directive("firstNameInput",["$templateCache",function(){var t=function(){};return{restrict:"AEC",link:t,templateUrl:"last-name-input.html"}}]),e.directive("checkoutEmail",["$timeout","CheckoutValidation","$templateCache",function(e,n){var i=function(i,c){var o=c.children()[1].children[1];i.onEmailBlur=function(){i.checkout.email&&(t.element(o).addClass("ion-loading-d"),e(function(){return n.validateEmail(i.checkout.email)?(t.element(o).removeClass("ion-loading-d"),void t.element(o).addClass("ion-checkmark-round").css({color:"#1fda9a"})):(t.element(o).removeClass("ion-loading-d"),void t.element(o).addClass("ion-close-round").css({color:"#ED303C"}))},300))},i.onEmailFocus=function(){t.element(o).removeClass("ion-checkmark-round ion-close-round").css({color:"#333"})}};return{restrict:"AEC",link:i,templateUrl:"email-input.html"}}]),e.directive("mouseDownUp",function(){var t=function(t,e){e.on("touchstart",function(){e.css({opacity:.5})}),e.on("touchend",function(){e.css({opacity:1})})};return{restrict:"AC",link:t}})}(angular),function(t){t.module("ionicShop.templates",["ionic"]).run(["$templateCache",function(t){t.put("cart-item.html","<div ng-if='!emptyProducts'>\n  <div class='card product-card' ng-repeat='product in products track by $index'>\n    <div class='item item-thumbnail-right product-item'>\n      <img ng-src='{{product.images[0]}}' class='product-image' ion-product-image='product'>\n      <h3 class='product-title'>{{product.title}}</h3>\n      <p class='product-description'>{{product.description}}</p>\n\n      <i class='icon ion-plus-round icon-plus-round' mouse-down-up ng-click='addProduct(product)'></i>\n         <span class='product-quantity'>{{product.quantity}}</span>\n      <i class='icon ion-minus-round icon-minus-round' mouse-down-up ng-click='removeProduct(product)'></i>\n\n      <span class='product-price'>${{product.price}}</span>\n    </div>\n  </div>\n  <div>\n    <br><br><br><br>\n  </div>\n</div>\n\n<div class='empty-cart-div' ng-if='emptyProducts'>\n  <h3 class='empty-cart-header'>Your bag is empty!</h3>\n  <i class='icon ion-bag empty-cart-icon'></i>\n</div>"),t.put("checkout-footer.html","<div class='title'>Checkout</div>"),t.put("purchase-footer.html","<div class='title'>Pay</div>"),t.put("purchase.html","\n<span class='purchase-form-description'>Please enter your credit card details:</span>\n\n<div class='list purchase-form'>\n  <checkout-name ng-if='hasNameDir'></checkout-name>\n  <checkout-card></checkout-card>\n  <checkout-address ng-if='hasAddressDir'></checkout-address>\n  <checkout-email ng-if='hasEmailDir'></checkout-email>\n</div>\n\n<h2 class='purchase-total'>Total: ${{total}}</h2>\n"),t.put("partials/address-line-one.html","<label class='item item-input'>\n  <input type='text' ng-model='checkout.addressLineOne' placeholder='Address Line 1'>\n</label>"),t.put("partials/address-line-two.html","<label class='item item-input'>\n  <input type='text' ng-model='checkout.addressLineTwo' placeholder='Address Line 2'>\n</label>"),t.put("partials/address.html","<div class='item item-divider'>Address: </div>\n<address-one-input></address-one-input>\n<address-two-input></address-two-input>\n<city-input></city-input>\n<state-input></state-input>\n<zip-input></zip-input>\n"),t.put("partials/card-cvc-input.html","<label class='item item-input'>\n  <input type='tel' ng-model='checkout.cvc' ng-focus='onCvcFocus()' ng-blur='onCvcBlur()' placeholder='CVC'>\n  <i class=\"icon\" style='width: 40px; text-align: center;'></i>\n</label>"),t.put("partials/card-exp-input.html","<label class='item item-input'>\n  <input type='tel' ng-model='checkout.exp' ng-focus='onExpFocus()' ng-blur='onExpBlur()' placeholder='MM/YYYY'>\n  <i  class=\"icon\" style='width: 40px; text-align: center;'></i>\n</label>"),t.put("partials/card-form.html","<div class='item item-divider'>Card Info: </div>\n<card-num-input></card-num-input>\n<card-exp-input></card-exp-input>\n<card-cvc-input></card-cvc-input>"),t.put("partials/card-num-input.html","<label class='item item-input'>\n  <input type='tel' ng-model='checkout.cc' ng-focus='onNumFocus()' ng-blur='onNumBlur()' placeholder='Credit Card Number'>\n  <i  class=\"icon ion-card\" style='width: 40px; text-align: center;'></i>\n</label>"),t.put("partials/cart-image-modal.html","<div class=\"modal image-slider-modal\">\n\n  <ion-header-bar>\n    <button class=\"button button-light icon ion-ios7-undo-outline\" ng-click='closeModal()'></button>\n    <h1 class=\"title\">More Images</h1>\n    \n  </ion-header-bar>\n\n    <ion-slide-box class='image-slider-box' does-continue='true'>\n      <ion-slide ng-repeat='image in product.images' class='image-ion-slide'>\n        <ion-content>\n          <div class='image-slide-div'>\n            <h3 class='image-slide-description'>{{product.description}}</h3>\n            <img src='{{image}}' class='image-slide'>\n          </div>\n        </ion-content>\n      </ion-slide>\n    </ion-slide-box>\n\n</div>"),t.put("partials/city-input.html","<label class='item item-input'>\n  <input type='text' ng-model='checkout.city' placeholder='City'>\n</label>"),t.put("partials/email-input.html",'<div class="item item-divider">E-mail: </div>\n<label class="item item-input">\n  <input type="text" ng-model="checkout.email" ng-focus=\'onEmailFocus()\' ng-blur=\'onEmailBlur()\' placeholder="E-Mail">\n  <i class="icon" style=\'width: 40px; text-align: center;\'></i>\n</label>\n\n'),t.put("partials/first-name-input.html","  <label class='item item-input'>\n    <input type='text' ng-model='checkout.lastName' placeholder='Last Name'>\n  </label>"),t.put("partials/last-name-input.html","  <label class='item item-input'>\n    <input type='text' ng-model='checkout.firstName' placeholder='First Name'>\n  </label>"),t.put("partials/name-input.html","<div class='item item-divider'>Name: </div>\n<first-name-input></first-name-input>\n<last-name-input></last-name-input>"),t.put("partials/state-input.html","<label class='item item-input'>\n  <input type='text' ng-model='checkout.state' placeholder='State'>\n</label>"),t.put("partials/zipcode-input.html","<label class='item item-input'>\n  <input type='text' ng-model='checkout.zipcode' ng-focus='onZipFocus()' ng-blur='onZipBlur()' placeholder='Zipcode'>\n  <i class=\"icon\" style='width: 40px; text-align: center;'></i>\n</label>")}])}(angular),function(t){t.module("ionicShop",["ionic","ionicShop.services","ionicShop.directives","ionicShop.templates"])}(angular);